# JIT
![[Pasted image 20220714215640.png]]
![[Pasted image 20220714215618.png]]
c1编译快但是不对代码做优化，c2编译慢但对代码做优化。分层编译就是结合两者的优点，在项目启动时用c1，运行一段时间后用c2

![[Pasted image 20220718210956.png]]
# JIT的优化
只有热点代码才会触发JIT的优化
## 方法内联
将目标方法复制到发起方法中，避免发生真正的调用

热点方法的内联可以有效提高系统性能，一般可以通过以下集中方式提高方法内联：
- 设置JVM参数来降低内联的触发阈值
- 避免在一个方法内写大量代码，要尽量写小方法体。因为方法过大会增加编译时间，导致JIT不进行内联而使用解释器
- 尽量使用final、private、static，这种私阈成员可以避免额外的类型检查

## 锁消除
单线程的sychronized会被消除

## 栈上分配
![[Pasted image 20220718213418.png]]
栈上分配的好处：快、不用担心GC（方法执行完就可以回收）
前1w次不会栈上分配