如果元空间过小，会引起项目启动时频繁的full gc（因为代码量较大，有较多的类信息要加载）。元空间如果不设置的话，是会动态调整大小的。

# 常量池&运行时常量池（1.8后在元空间）
常量池(constant pool table)，用于存放编译期生成的各种字面量和符号引用。
使用```javap -v xxx.class```可以查看某个字节码文件中的常量池：
![[Pasted image 20220213213733.png]]
```java
int a=1;
int s="abc"
```
字面量就是等号右边的值，符号引用就是左边的变量名。除此之外，符号应用还包括：类和接口的全限定名、字段的名称和描述符、方法的名称和描述符。

这些常量池现在是静态信息，只有到运行时被加载到内存后，这些符号才有对应的内存地址信息，这些常量池一旦被装 入内存就变成运行时常量池，对应的符号引用在程序加载或运行时会被转变为被加载到内存区域的代码的直接引用，也 就是我们说的动态链接了。例如，compute()这个符号引用在运行时就会被转变为compute()方法具体代码在内存中的 地址，主要通过对象头里的类型指针去转换直接引用。

# 字符串常量池（1.8后在堆中）
```java
String s="abc"; //s指向常量池
String s=new String("abc"); //s指向堆中的对象
```
String s=new String("abc"); 但是当常量池中没有"abc"时，还会先在常量池中创建一个"abc"。
![[Pasted image 20220213221501.png]]
![[Pasted image 20220213221603.png]]
![[Pasted image 20220213221831.png]]
![[Pasted image 20220213222552.png]]
![[Pasted image 20220213222757.png]]