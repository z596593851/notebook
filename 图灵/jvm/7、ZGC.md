![[Pasted image 20220620211850.png]]


![[Pasted image 20220620212644.png]]
linux2.6引入标准大页，如果内存是GB级别，那么用2M来分页，如果是TB级别，那么用1G来分页。
UMA：统一内存访问，指以前cpu在访问内存时要通过总线
NUMA：非统一内存访问，指cpu和内存被放在了一个单元上，这时cpu访问内存的速度会加快
ZGC支持NUMA
![[Pasted image 20220621232004.png]]
ZGC不用对象头来记录垃圾回收的相关信息，而是用对象指针的高位：42、43、45，这就是所谓的指针着色计技术
![[Pasted image 20220621232655.png]]

一次ZGC的流程
![[Pasted image 20220621234104.png]]

![[Pasted image 20220621235020.png]]
![[Pasted image 20220622000020.png]]

转移阶段
![[Pasted image 20220622001447.png]]
![[Pasted image 20220622001629.png]]

并发转移准备：将垃圾较多的页面的回收优先级调高，同时如果某个页面全是垃圾则直接回收
初始转移：stw，将初始标记标记的对象进行转移
并发转移：转移并发标记阶段标记的阶段，由于此时用户线程还在进行，为了防止有些线程还在使用转移以前的旧地址，这里会引入一个转移表，来标记新旧地址间的映射，并且转移操作和修改转发表是原子操作