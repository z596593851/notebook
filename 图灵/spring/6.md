prepareBeanFactory：
添加ApplicationContextAwareProcessor、ApplicationListenerDetector
spring自己的属性注入时，忽略实现了以下接口的set方法：
![[Pasted image 20220310174825.png]]
注入一些实例以便可以直接拿到：
![[Pasted image 20220310175006.png]]
![[Pasted image 20220310174959.png]]

invokeBeanFactoryPostProcessors：扫描

registerBeanPostProcessors：注册自己定义的beanPostProcessor

initApplicationEventMulticaster：注册事件发布器

registerListeners：注册事件监听器

finishBeanFactoryInitialization：
设置占位符解析器 ${xxx}
实例化非懒加载的单利bean


BeanFactoryPostProcessor理解为BeanFactory的后置处理器，用来用对BeanFactory进行加工的。例如我们可以实现BeanFactoryPostProcessor，获取容器中的bd并进行修改：
```java
public class ZhouyuBeanFactoryPostProcessor implements BeanFactoryPostProcessor {

    @Override

    public void postProcessBeanFactory(ConfigurableListableBeanFactory beanFactory) throws BeansException {
        BeanDefinition beanDefinition = beanFactory.getBeanDefinition("userService");
        beanDefinition.setAutowireCandidate(false);
    }

}
```
BeanFactoryPostProcessor不能注册bd，可以实现他的子接口BeanDefinitionRegistryPostProcessor：
```java
public interface BeanDefinitionRegistryPostProcessor extends BeanFactoryPostProcessor { 
    void postProcessBeanDefinitionRegistry(BeanDefinitionRegistry registry);
}
```